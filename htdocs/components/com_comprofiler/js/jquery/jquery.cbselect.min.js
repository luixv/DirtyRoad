(function(g){var h=[];var b={};var t={init:function(p){return this.each(function(){var e=this;var l=g(e).data("cbselect");if(l||g(e).hasClass("select2")){return}l={};l.type=g(e).prop("multiple")?"multiple":"single";l.options=typeof p!="undefined"?p:{};l.defaults=g.fn.cbselect.defaults;l.settings=g.extend(true,{},l.defaults,l.options);l.element=g(e);if(l.settings.useData){g.each(l.defaults,function(e,t){if(e!="init"&&e!="useData"){var s=l.element.data("cbselect"+e.charAt(0).toUpperCase()+e.slice(1));if(typeof s!="undefined"){l.settings[e]=s}else{s=l.element.data("cbselect"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());if(typeof s!="undefined"){l.settings[e]=s}}}})}l.element.triggerHandler("cbselect.init.before",[l]);if(!l.settings.init){return}if(l.settings.tags){var t=l.settings.separator;if(!t){t=[","]}l.settings.tokenSeparators=t}if(l.type=="multiple"||l.settings.tags){if(l.settings.width=="calculate"){l.settings.width="auto"}if(l.settings.height=="calculate"){l.settings.height="auto"}}if(l.element.find("option:empty")){l.element.find("option:empty").html("&nbsp;")}var s=null;var n=null;if(l.settings.width=="calculate"||l.settings.height=="calculate"){s=l.element.outerWidth()+50;n=l.element.outerHeight();if(l.element.is(":hidden")){var a=l.element.css("width");var i=l.element.css("height");var r=l.element.clone(false).attr({id:"",class:""}).css({position:"absolute",display:"block",visibility:"hidden",width:"auto",height:"auto",minWidth:a&&a!="0px"?a:"auto",minHeight:i&&i!="0px"?i:"auto",padding:l.element.css("padding"),border:l.element.css("border"),margin:l.element.css("margin"),fontFamily:l.element.css("font-family"),fontSize:l.element.css("font-size"),fontWeight:l.element.css("font-weight"),lineHeight:l.element.css("line-height"),boxSizing:l.element.css("box-sizing"),wordSpacing:l.element.css("word-spacing")}).appendTo("body");s=r.outerWidth()+50;n=r.outerHeight();r.remove()}if(l.settings.width=="calculate"){l.settings.width=s}if(l.settings.height=="calculate"){l.settings.height=n}}if(l.settings.width=="element"){s=l.element.outerWidth();if(!s||s=="0px"){s="auto"}}else if(l.settings.width=="copy"||l.settings.width=="resolve"){s=l.element.css("width");if(!s||s=="0px"){s="auto"}}else if(l.settings.width=="off"){s=null}else if(!s){s=l.settings.width}if(l.settings.height=="element"){n=l.element.outerHeight();if(!n||n=="0px"){n="auto"}}else if(l.settings.height=="copy"||l.settings.height=="resolve"){n=l.element.css("height");if(!n||n=="0px"){n="auto"}}else if(l.settings.height=="off"){n=null}else if(!n){n=l.settings.height}var o=null;if(l.type=="multiple"){if(s=="auto"&&l.settings.placeholder){var c=g("<span>"+l.settings.placeholder+"</span>").css({position:"absolute",display:"block",visibility:"hidden",padding:l.element.css("padding"),border:l.element.css("border"),margin:l.element.css("margin"),fontFamily:l.element.css("font-family"),fontSize:l.element.css("font-size"),fontWeight:l.element.css("font-weight"),lineHeight:l.element.css("line-height"),boxSizing:l.element.css("box-sizing"),wordSpacing:l.element.css("word-spacing")}).appendTo("body");o=c.outerWidth()+5;c.remove()}}else if(l.settings.placeholder){l.settings.allowClear=true}var d=l.element.is('.cbTooltip,[data-hascbtooltip="true"]');if(d){l.element.attr("data-cbtooltip-open-target","~ .select2-container:first");l.element.attr("data-cbtooltip-close-target","~ .select2-container:first");l.element.attr("data-cbtooltip-position-target","~ .select2-container:first");l.element.data("cbtooltip-open-target","~ .select2-container:first");l.element.data("cbtooltip-close-target","~ .select2-container:first");l.element.data("cbtooltip-position-target","~ .select2-container:first")}var f=[];g.each(l.element.attr("class").split(/\s+/),function(e,t){if(t!="cbTooltip"&&t!="cbSelect"){f.push(t)}});var u=g.extend(true,{},l.settings);delete u["separator"];delete u["containerCssClass"];delete u["dropdownCssClass"];delete u["selectionCssClass"];if(u["dropdownParent"]&&typeof u["dropdownParent"]==="string"){var m=l.element.closest(u["dropdownParent"]);if(m.length){u["dropdownParent"]=m;if(!l.settings.dropdownCssClass){l.settings.dropdownCssClass="select2-container--fullwidth"}}else{u["dropdownParent"]=null}}if(l.settings.theme=="bootstrap"&&(l.type=="multiple"||l.settings.tags)&&!("templateSelection"in u)){u["templateSelection"]=function(e,t){t.addClass("badge badge-primary");return g.fn.select2.defaults.defaults.templateSelection(e,t)}}if(l.settings.url){l.ajax_url=null;l.ajax_restore=false;l.ajax_term="";l.ajax_page=1;if(l.element.children("optgroup,option").length){u["dataAdapter"]=g.fn.select2.amd.require("select2/data/ajax-extended")}u["ajax"]={url:l.settings.url,data:function(e){return{search:g.trim(e.term||""),page:e.page||1}},dataType:"json",delay:600,cache:true,transport:function(e,t,s){var n=g.ajax(e);if(l.ajax_restore){n.always(function(){l.ajax_restore=false;l.select2.results.loading=false;l.select2.results.lastParams.term=l.ajax_term;l.select2.results.lastParams.page=l.ajax_page;e.term=l.ajax_term;e.page=l.ajax_page})}else{n.always(t)}return n},beforeSend:function(e,t){l.ajax_url=t.url;if(l.ajax_url in b){return false}l.element.triggerHandler("cbselect.ajax.send",[l,t]);return true},processResults:function(e,t){l.element.triggerHandler("cbselect.ajax.data",[l,e,t]);if(l.ajax_url in b){l.ajax_term=t.term;l.ajax_page=t.page;return b[l.ajax_url]}t.page=t.page||1;b[l.ajax_url]=e;l.ajax_term=t.term;l.ajax_page=t.page;return e}}}l.element.select2(u);l.select2=l.element.data("select2");l.container=l.select2.$container;l.dropdown=l.select2.$dropdown;l.selection=l.select2.$selection;l.searchable=!(l.settings.minimumResultsForSearch<0||l.element.find("option").length<l.settings.minimumResultsForSearch);if(o){l.selection.css("min-width",o)}g.each(f,function(e,t){l.container.addClass(t)});if(l.settings.theme=="bootstrap"){if(!l.settings.tags&&l.container.hasClass("form-control")){l.container.addClass("custom-select");if(l.container.hasClass("form-control-sm")){l.container.addClass("custom-select-sm")}else if(l.container.hasClass("form-control-lg")){l.container.addClass("custom-select-lg")}}l.dropdown.find(".select2-dropdown").addClass("bg-white border");l.dropdown.find(".select2-search__field").addClass("form-control");l.container.find(".select2-search__field").addClass("form-control");if(l.container.hasClass("form-control-sm")){l.dropdown.find(".select2-dropdown").addClass("text-small");l.dropdown.find(".select2-search__field").addClass("form-control-sm");l.container.find(".select2-search__field").addClass("form-control-sm")}else if(l.container.hasClass("form-control-lg")){l.dropdown.find(".select2-dropdown").addClass("text-large");l.dropdown.find(".select2-search__field").addClass("form-control-lg");l.container.find(".select2-search__field").addClass("form-control-lg")}else if(l.settings.url){l.dropdown.find(".select2-search__field").addClass("form-control-sm")}}l.dropdown.addClass("cb_template");if(l.type=="multiple"){l.dropdown.addClass("select2-container--multiple");l.container.addClass("select2-container--multiple")}else{l.dropdown.addClass("select2-container--single");l.container.addClass("select2-container--single")}if(l.settings.tags){l.dropdown.addClass("select2-container--tags");l.container.addClass("select2-container--tags")}l.container.on("click.cbselect",function(e){if(e.target!==this){return}l.element.cbselect("toggle")}).on("keydown.cbselect",function(e){if(g(this).hasClass("select2-container--disabled")||g(this).hasClass("select2-container--open")){return}if((e.key=="Down"||e.key=="ArrowDown")&&!e.altKey){var t=l.element.find("option").index(l.element.find("option:selected"));var s=l.element.find("option").slice(t+1).filter(":enabled").first().val();if(typeof s!="undefined"){l.element.val(s).trigger("change")}e.preventDefault()}else if(e.key=="Up"||e.key=="ArrowUp"){var n=l.element.find("option").index(l.element.find("option:selected"));var a=l.element.find("option").slice(0,n).filter(":enabled").last().val();if(typeof a!="undefined"){l.element.val(a).trigger("change")}e.preventDefault()}}).on("keypress.cbselect",function(e){if(g(this).hasClass("select2-container--disabled")||g(this).hasClass("select2-container--open")){return}if(l.type!="single"||!l.searchable||e.altKey||e.ctrlKey||e.metaKey||e.key.length!==1||!/[a-zA-Z]/.test(e.key)){return}l.element.select2("open");l.dropdown.find(".select2-search > input").val(e.key).trigger("change")});l.element.on("select2:opening.cbselect",function(e){if(l.element.hasClass("disabled")||l.element.is(":disabled")||l.container.hasClass("disabled")||l.container.is(":disabled")){e.preventDefault()}if(l.settings.url&&l.ajax_restore){l.dropdown.find(".select2-search > input").val(l.ajax_term)}}).on("select2:open.cbselect",function(){l.element.triggerHandler("cbselect.open",[l])}).on("select2:close.cbselect",function(){if(l.settings.url&&!l.settings.tags){l.ajax_restore=true}l.element.triggerHandler("cbselect.close",[l])}).on("select2:select.cbselect",function(e){if(l.settings.placeholder){l.element.cbselect("unset",l.select2.selection.placeholder.id)}l.element.triggerHandler("cbselect.selecting",[l,e.params.data.id,e.params.data.element])}).on("select2:unselect.cbselect",function(e){if(l.settings.placeholder&&l.element.cbselect("get")===null){l.element.cbselect("set",l.select2.selection.placeholder.id)}l.element.triggerHandler("cbselect.removing",[l,e.params.data.id,e.params.data.element])});if(l.element.hasClass("btn")){l.selection.on("focus.cbselect",function(){if(g(this).hasClass("select2-container--disabled")){return}l.container.addClass("focus")}).on("blur.cbselect",function(){l.container.removeClass("focus")})}l.container.attr("id","cbselect_"+l.element.attr("id"));if(n&&n!="0px"){l.container.css("height",n)}if(l.settings.containerCssClass){l.container.addClass(l.settings.containerCssClass)}if(l.settings.dropdownCssClass){l.dropdown.addClass(l.settings.dropdownCssClass)}if(l.settings.selectionCssClass){l.selection.addClass(l.settings.selectionCssClass)}l.element.on("change.cbselect",function(){if(typeof cbParamChange!="undefined"){cbParamChange.call(this)}});l.element.on("remove.cbselect destroy.cbselect",function(){l.element.cbselect("destroy")});l.element.on("rebind.cbselect",function(){l.element.cbselect("rebind")});l.element.on("modified.cbselect",function(e,t,s,n){if(t!=s){l.element.cbselect("rebind")}});l.element.on("cloning.cbselect",function(){g(this).cbselect("destroy");g(this).on("rebind.cbselect",function(){g(this).off("rebind.cbselect");l.element.cbselect(l.options)});g(this).on("cloned.cbselect",function(){g(this).off("cloned.cbselect");g(this).cbselect(l.options)});return true});l.element.triggerHandler("cbselect.init.after",[l]);l.element.data("cbselect",l);h.push(l)})},toggle:function(){var e=g(this).data("cbselect");if(!e){return this}if(e.container.hasClass("select2-container--open")){e.element.select2("close")}else{e.element.select2("open")}return this},open:function(){var e=g(this).data("cbselect");if(!e){return this}e.element.select2("open");return this},close:function(e){var t=g(this).data("cbselect");if(!t){return this}t.element.select2("close");return this},get:function(){var e=g(this).data("cbselect");if(!e){return null}return e.element.val()},set:function(e){var t=g(this).data("cbselect");if(!t){return null}t.element.val(e).trigger("change");return t.element.cbselect("get")},unset:function(e){var t=g(this).data("cbselect");if(!t){return null}if(!g.isArray(e)){e=[e]}var s=t.element.cbselect("get");var n=s;var a=false;if(g.isArray(s)){g.each(e,function(e,t){if(n.indexOf(t)>-1){n.splice(n.indexOf(t),1);a=true}})}else{g.each(e,function(e,t){if(t===s){n="";a=true;return false}})}if(a){return t.element.cbselect("set",n)}else{return s}},enable:function(){var e=g(this).data("cbselect");if(!e){return this}e.element.prop("disabled",false);return this},disable:function(){var e=g(this).data("cbselect");if(!e){return this}e.element.prop("disabled",true);return this},container:function(){var e=g(this).data("cbselect");if(!e){return this}return e.container},dropdown:function(){var e=g(this).data("cbselect");if(!e){return this}return e.dropdown},rebind:function(){var e=g(this).data("cbselect");if(!e){return this}e.element.cbselect("destroy");e.element.cbselect(e.options);return this},destroy:function(){var s=g(this).data("cbselect");if(!s){return this}s.element.off(".cbselect");s.element.removeData("cbselect");if(s.element.is('.cbTooltip,[data-hascbtooltip="true"]')){s.element.removeAttr("data-cbtooltip-open-target");s.element.removeAttr("data-cbtooltip-close-target");s.element.removeAttr("data-cbtooltip-position-target");s.element.removeData("cbtooltip-open-target");s.element.removeData("cbtooltip-close-target");s.element.removeData("cbtooltip-position-target")}s.element.select2("destroy");g.each(h,function(e,t){if(t.element==s.element){h.splice(e,1);return false}return true});s.element.triggerHandler("cbselect.destroyed",[s]);return this},instances:function(){return h}};g.fn.select2.amd.define("select2/data/ajax-extended",["./array","./ajax","./tags","../utils","module","jquery"],function(e,t,s,n,a,l){function i(e,t){this.minimumInputLength=t.get("minimumInputLength");this.paginationMore=t.get("paginationMore");this.paginationPage=t.get("paginationPage");i.__super__.constructor.call(this,e,t)}n.Extend(i,t);var r=e.prototype.query;var o=t.prototype.query;i.prototype.query=function(s,n){if((!s.term||s.term.length<this.minimumInputLength)&&(s._type&&s._type=="query")){var a=this.$element.data("cbselect");if(a&&a.ajax_restore){a.ajax_restore=false;a.select2.results.loading=false;a.select2.results.lastParams.term=a.ajax_term;a.select2.results.lastParams.page=a.ajax_page;s.term=a.ajax_term;s.page=a.ajax_page;return}var l=this;var e=function(e){if(a){a.ajax_url=null}e["pagination"]={more:l.paginationMore||false,page:l.paginationPage||1};var t=l.processResults(e,s);n(t)};r.call(this,s,e)}else{o.call(this,s,n)}};if(a.config().tags){return n.Decorate(i,s)}else{return i}});g.fn.cbselect=function(e){if(t[e]){return t[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return t.init.apply(this,arguments)}return this};g.fn.cbselect.defaults={init:true,useData:true,url:null,tags:false,separator:null,placeholder:null,closeOnSelect:true,selectOnClose:false,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,dropdownCssClass:null,containerCssClass:null,selectionCssClass:null,dropdownAutoWidth:true,theme:"bootstrap",width:"calculate",height:"off"}})(jQuery);