(function(c){var d=[];var s={init:function(o){return this.each(function(){var s=this;var i=c(s).data("cbmoreless");if(i){return}i={};i.options=typeof o!="undefined"?o:{};i.defaults=c.fn.cbmoreless.defaults;i.settings=c.extend(true,{},i.defaults,i.options);i.element=c(s);if(i.settings.useData){c.each(i.defaults,function(e,s){if(e!="init"&&e!="useData"){var t=i.element.data("cbmoreless"+e.charAt(0).toUpperCase()+e.slice(1));if(typeof t!="undefined"){i.settings[e]=t}else{t=i.element.data("cbmoreless"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase());if(typeof t!="undefined"){i.settings[e]=t}}}})}i.element.triggerHandler("cbmoreless.init.before",[i]);if(!i.settings.init){return}if(!i.settings.height){i.settings.height=100}if(i.element.children(".cbMoreLessOpen.fade-edge,.cbMoreLessClose.fade-edge").length){var t=null;i.element.parents().each(function(){var e=c(this).css("background-color");if(e&&(e!=""&&e!="transparent"&&e!="rgba(0, 0, 0, 0)")){t=e;return false}});if(t){i.element.children(".cbMoreLessOpen.fade-edge,.cbMoreLessClose.fade-edge").css("background-image","linear-gradient(to bottom, rgba(255, 255, 255, 0) 0%, "+t+" 100%)");i.element.children(".cbMoreLessOpen,.cbMoreLessClose").find(".cbMoreLessButton").css("background-color",t)}}i.openHandler=function(e){e.preventDefault();a.call(s,i)};i.closeHandler=function(e){e.preventDefault();h.call(s,i)};i.element.children(".cbMoreLessOpen").on("click",i.openHandler);i.element.children(".cbMoreLessClose").on("click",i.closeHandler);if(!i.element.hasClass("cbMoreLessOpened")){i.element.removeClass("cbMoreLessClosed");i.element.children(".cbMoreLessOpen,.cbMoreLessClose").addClass("hidden");var e=i.element.children(".cbMoreLessContent");i.height=e.height();if(i.settings.height){e.css("max-height",i.settings.height);e.css("height",i.settings.height)}if(typeof e.get(0)!="undefined"){var n=e.height();var r=e.prop("scrollHeight");if(e.is(":hidden")&&r==0){var l=e.parents(":hidden");l.each(function(){c(this).addClass("cbForceDisplay")});n=e.height();r=e.prop("scrollHeight");l.each(function(){c(this).removeClass("cbForceDisplay")})}i.height=r;if(i.settings.tolerance){if(typeof i.settings.tolerance=="string"&&i.settings.tolerance.indexOf("%")!==-1){if(i.settings.height){n+=i.settings.height*(i.settings.tolerance.replace("%","")/100)}}else{n+=i.settings.tolerance}}if(n<r){h.call(this,i)}else{a.call(this,i)}}else{a.call(this,i)}if(i.settings.height){e.css("height","")}}i.element.on("remove.cbmoreless destroy.cbmoreless",function(){i.element.cbmoreless("destroy")});i.element.on("rebind.cbmoreless",function(){i.element.cbmoreless("rebind")});i.element.on("modified.cbmoreless",function(e,s,t,n){if(s!=t){i.element.cbmoreless("rebind")}});i.element.on("cloned.cbmoreless",function(){if(i.settings.height){c(this).children(".cbMoreLessContent").css("max-height","none")}c(this).off(".cbmoreless");c(this).children(".cbMoreLessOpen").off("click",i.openHandler).addClass("hidden");c(this).children(".cbMoreLessClose").off("click",i.closeHandler).addClass("hidden");c(this).removeClass("cbMoreLessOpened cbMoreLessClosed");c(this).removeData("cbmoreless");c(this).cbmoreless(i.options)});i.element.triggerHandler("cbmoreless.init.after",[i]);i.element.data("cbmoreless",i);d.push(i)})},open:function(){var e=c(this).data("cbmoreless");if(!e){return this}a.call(this,e);return this},close:function(){var e=c(this).data("cbmoreless");if(!e){return this}h.call(this,e);return this},rebind:function(){var e=c(this).data("cbmoreless");if(!e){return this}e.element.cbmoreless("destroy");e.element.cbmoreless(e.options);return this},destroy:function(){var e=c(this).data("cbmoreless");if(!e){return this}if(e.settings.height){e.element.children(".cbMoreLessContent").css("max-height","none")}e.element.off(".cbmoreless");e.element.children(".cbMoreLessOpen").off("click",e.openHandler).addClass("hidden");e.element.children(".cbMoreLessClose").off("click",e.closeHandler).addClass("hidden");e.element.removeClass("cbMoreLessOpened cbMoreLessClosed");e.element.removeData("cbmoreless");e.element.triggerHandler("cbmoreless.destroyed",[e]);return this},instances:function(){return d}};function a(e){if(e.settings.height){var s="none";if(e.settings.stepped){s="+="+e.settings.height+"px"}e.element.children(".cbMoreLessContent").css("max-height",s)}if(e.settings.stepped){var t=e.element.children(".cbMoreLessContent").height();if(t>=e.height){e.element.removeClass("cbMoreLessClosed cbMoreLessStepped").addClass("cbMoreLessOpened");e.element.children(".cbMoreLessOpen").addClass("hidden");e.element.children(".cbMoreLessClose").removeClass("hidden")}else if(t<=e.height){e.element.removeClass("cbMoreLessOpened cbMoreLessClosed").addClass("cbMoreLessStepped");e.element.children(".cbMoreLessClose").removeClass("hidden")}}else{e.element.removeClass("cbMoreLessClosed").addClass("cbMoreLessOpened");e.element.children(".cbMoreLessOpen").addClass("hidden");e.element.children(".cbMoreLessClose").removeClass("hidden")}}function h(e){if(e.settings.height){var s=e.settings.height;if(e.settings.stepped&&e.element.children(".cbMoreLessContent").height()>e.settings.height){s="-="+e.settings.height+"px"}e.element.children(".cbMoreLessContent").css("max-height",s)}if(e.settings.stepped){var t=e.element.children(".cbMoreLessContent").height();if(t<=e.settings.height){e.element.removeClass("cbMoreLessOpened cbMoreLessStepped").addClass("cbMoreLessClosed");e.element.children(".cbMoreLessOpen").removeClass("hidden");e.element.children(".cbMoreLessClose").addClass("hidden")}else if(t<=e.height){e.element.removeClass("cbMoreLessOpened cbMoreLessClosed").addClass("cbMoreLessStepped");e.element.children(".cbMoreLessOpen").removeClass("hidden")}}else{e.element.removeClass("cbMoreLessOpened").addClass("cbMoreLessClosed");e.element.children(".cbMoreLessOpen").removeClass("hidden");e.element.children(".cbMoreLessClose").addClass("hidden")}}c.fn.cbmoreless=function(e){if(s[e]){return s[e].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof e==="object"||!e){return s.init.apply(this,arguments)}return this};c.fn.cbmoreless.defaults={init:true,useData:true,stepped:false,height:100,tolerance:"25%"}})(jQuery);