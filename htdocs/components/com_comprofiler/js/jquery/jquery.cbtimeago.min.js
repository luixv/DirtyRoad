(function(n){var a=[];var e={init:function(i){return this.each(function(){var t=this;var s=n(t).data("cbtimeago");if(s){return}s={};s.options=typeof i!="undefined"?i:{};s.defaults=n.fn.cbtimeago.defaults;s.settings=n.extend(true,{},s.defaults,s.options);s.element=n(t);s.datetime=s.element.data("cbtimeago-datetime");if(!s.datetime){s.datetime=s.element.attr("title");if(!s.datetime){s.datetime=s.element.text()}}if(s.settings.useData){n.each(s.defaults,function(t,e){if(t!="init"&&t!="useData"){var i=s.element.data("cbtimeago"+t.charAt(0).toUpperCase()+t.slice(1));if(typeof i!="undefined"){s.settings[t]=i}else{i=s.element.data("cbtimeago"+t.charAt(0).toUpperCase()+t.slice(1).toLowerCase());if(typeof i!="undefined"){s.settings[t]=i}}}})}s.element.triggerHandler("cbtimeago.init.before",[s]);if(!s.settings.init){return}if(s.settings.hideAgo){s.settings.strings.future="%s";s.settings.strings.past="%s"}var e=null;if(typeof moment!="undefined"){e=moment.locale();moment.locale(Math.random(),{relativeTime:{future:s.settings.strings.future,past:s.settings.strings.past,s:s.settings.strings.seconds,m:s.settings.strings.minute,mm:s.settings.strings.minutes,h:s.settings.strings.hour,hh:s.settings.strings.hours,d:s.settings.strings.day,dd:s.settings.strings.days,M:s.settings.strings.month,MM:s.settings.strings.months,y:s.settings.strings.year,yy:s.settings.strings.years}})}s.livestamp=s.element.livestamp(s.datetime);if(e){moment.locale(e)}s.element.on("remove.cbtimeago destroy.cbtimeago",function(){s.element.cbtimeago("destroy")});s.element.on("rebind.cbtimeago",function(){s.element.cbtimeago("rebind")});s.element.on("modified.cbtimeago",function(t,e,i,n){if(e!=i){s.element.cbtimeago("rebind")}});s.element.on("cloned.cbtimeago",function(){n(this).off(".cbtimeago");n(this).removeData("cbtimeago");n(this).removeData("livestampdata");n(this).text("");if(!n(this).data("cbtimeago-datetime")&&!n(this).attr("title")){n(this).text(s.datetime)}n(this).cbtimeago(s.options)});s.element.triggerHandler("cbtimeago.init.after",[s]);s.element.data("cbtimeago",s);a.push(s)})},rebind:function(){var t=n(this).data("cbtimeago");if(!t){return this}t.element.cbtimeago("destroy");t.element.cbtimeago(t.options);return this},destroy:function(){var i=n(this).data("cbtimeago");if(!i){return this}i.element.livestamp("destroy");i.element.off(".cbtimeago");n.each(a,function(t,e){if(e.element==i.element){a.splice(t,1);return false}return true});i.element.text("");if(!i.element.data("cbtimeago-datetime")&&!i.element.attr("title")){i.element.text(i.datetime)}i.element.removeData("cbtimeago");i.element.triggerHandler("cbtimeago.destroyed",[i]);return this},instances:function(){return a}};n.fn.cbtimeago=function(t){if(e[t]){return e[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return e.init.apply(this,arguments)}return this};n.fn.cbtimeago.defaults={init:true,useData:true,hideAgo:false,strings:{future:"in %s",past:"%s ago",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years"}}})(jQuery);